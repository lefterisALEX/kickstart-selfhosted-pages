<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Getting_Started/preparation/external_secrets" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">External Secrets | KickstartSelfhostedServices</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://lefterisALEX.github.io/kickstart-selfhosted-pages/img/&lt;open-graph-card&gt;"><meta data-rh="true" name="twitter:image" content="https://lefterisALEX.github.io/kickstart-selfhosted-pages/img/&lt;open-graph-card&gt;"><meta data-rh="true" property="og:url" content="https://lefterisALEX.github.io/kickstart-selfhosted-pages/Getting_Started/preparation/external_secrets"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="External Secrets | KickstartSelfhostedServices"><meta data-rh="true" name="description" content="We are using Infisical to securely store all secrets related to your applications. Those secrets are pulled periodically (every 3 minutes) and can be used from the containers."><meta data-rh="true" property="og:description" content="We are using Infisical to securely store all secrets related to your applications. Those secrets are pulled periodically (every 3 minutes) and can be used from the containers."><link data-rh="true" rel="icon" href="/kickstart-selfhosted-pages/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://lefterisALEX.github.io/kickstart-selfhosted-pages/Getting_Started/preparation/external_secrets"><link data-rh="true" rel="alternate" href="https://lefterisALEX.github.io/kickstart-selfhosted-pages/Getting_Started/preparation/external_secrets" hreflang="en"><link data-rh="true" rel="alternate" href="https://lefterisALEX.github.io/kickstart-selfhosted-pages/Getting_Started/preparation/external_secrets" hreflang="x-default"><link rel="stylesheet" href="/kickstart-selfhosted-pages/assets/css/styles.76118980.css">
<script src="/kickstart-selfhosted-pages/assets/js/runtime~main.94aa18cd.js" defer="defer"></script>
<script src="/kickstart-selfhosted-pages/assets/js/main.84590a14.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/kickstart-selfhosted-pages/"><b class="navbar__title text--truncate">Kickstart Selfhosted Services</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" sidebarid="docsSidebar" href="/kickstart-selfhosted-pages/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/lefterisALEX/kickstart-selfhosted-pages" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"></a><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/kickstart-selfhosted-pages/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/kickstart-selfhosted-pages/how_it_works">How it works</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/kickstart-selfhosted-pages/costs">Cloud Costs</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/kickstart-selfhosted-pages/category/getting-started">Getting Started</a><button aria-label="Collapse sidebar category &#x27;Getting Started&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/kickstart-selfhosted-pages/category/preparation">Preparation</a><button aria-label="Collapse sidebar category &#x27;Preparation&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/kickstart-selfhosted-pages/Getting_Started/preparation/cicd">CICD</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/kickstart-selfhosted-pages/Getting_Started/preparation/cloud_provider">Cloud Provider</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/kickstart-selfhosted-pages/Getting_Started/preparation/vpn">VPN</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/kickstart-selfhosted-pages/Getting_Started/preparation/terraform_state">Terraform State</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/kickstart-selfhosted-pages/Getting_Started/preparation/cloudflare">DNS &amp; TLS certificates</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/kickstart-selfhosted-pages/Getting_Started/preparation/external_secrets">External Secrets</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kickstart-selfhosted-pages/Getting_Started/configuration_options">Configuration Options</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kickstart-selfhosted-pages/Getting_Started/deploy">Initial Deploy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/kickstart-selfhosted-pages/Getting_Started/add-new-services">Add more services</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kickstart-selfhosted-pages/category/how-to">How to</a><button aria-label="Expand sidebar category &#x27;How to&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/kickstart-selfhosted-pages/common-issues">Common Issues</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/kickstart-selfhosted-pages/faq">FAQ</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/kickstart-selfhosted-pages/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/kickstart-selfhosted-pages/category/getting-started"><span itemprop="name">Getting Started</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/kickstart-selfhosted-pages/category/preparation"><span itemprop="name">Preparation</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">External Secrets</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>External Secrets</h1></header>
<p>We are using <a href="https://infisical.com/" target="_blank" rel="noopener noreferrer">Infisical</a> to securely store all secrets related to your applications. Those secrets are pulled periodically (every 3 minutes) and can be used from the containers.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-project">Create a Project<a href="#create-a-project" class="hash-link" aria-label="Direct link to Create a Project" title="Direct link to Create a Project">​</a></h2>
<p>First thing is that we need to create a new project and save the project ID as github secret with name <code>INFISICAL_PROJECT_ID</code>
<img decoding="async" loading="lazy" src="/kickstart-selfhosted-pages/assets/images/infisical-project-id-8e30279cbc39cf7b26a77e3873d8ebb4.png" width="1638" height="919" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-identity">Create Identity<a href="#create-identity" class="hash-link" aria-label="Direct link to Create Identity" title="Direct link to Create Identity">​</a></h2>
<p>Navigate to <code>Admin</code> -&gt; <code>Access Control</code> -&gt; <code>Identities</code> .<br>
<!-- -->Press <strong>&quot;Create Identity&quot;</strong> and select as <strong>&quot;Member&quot;</strong> as Role
<img decoding="async" loading="lazy" src="/kickstart-selfhosted-pages/assets/images/infisical-create-identity-3339ad9d7ba485e20c35a1fa371c0b8b.png" width="1638" height="919" class="img_ev3q"></p>
<p>Then press <code>Universal Auth</code> and after press <code>Add client secret</code> , give it a name and press <strong>&quot;Create&quot;</strong>. Save the generated client secret as github secret with name <code>INFISICAL_CLIENT_SECRET</code>
<img decoding="async" loading="lazy" src="/kickstart-selfhosted-pages/assets/images/infisical-universal-auth-697ed9dc488f9bd34908672001589876.png" width="1631" height="919" class="img_ev3q">
<img decoding="async" loading="lazy" src="/kickstart-selfhosted-pages/assets/images/infisical-add-client-secret-ee5b47cb5d129e8bbfaebc18583d9d79.png" width="1631" height="919" class="img_ev3q">
<img decoding="async" loading="lazy" src="/kickstart-selfhosted-pages/assets/images/infisical-create-client-secret-5a097144cc22f30e5ba6bcfddd10dc92.png" width="1631" height="919" class="img_ev3q"></p>
<p>Copy the <code>Client ID</code> and save it as github secret with name <code>INFISICAL_CLIENT_ID</code><br>
<img decoding="async" loading="lazy" src="/kickstart-selfhosted-pages/assets/images/infisical-client-id-10b9455e908d5f313a70e280a5394a4a.png" width="1631" height="919" class="img_ev3q"></p>
<p>Now you should have 3 new secrets stored in github related with Infisical.</p>
<p><img decoding="async" loading="lazy" src="/kickstart-selfhosted-pages/assets/images/github-infisical-client-secret-a5cb33490cf0a7a352708ea09a744537.png" width="1631" height="919" class="img_ev3q"></p>
<p>Lastly assign the new identity as Project Viewer
<img decoding="async" loading="lazy" src="/kickstart-selfhosted-pages/assets/images/infisical-project-1-1eabfee1b67781aad8034c808e53e921.png" width="1631" height="919" class="img_ev3q">
<img decoding="async" loading="lazy" src="/kickstart-selfhosted-pages/assets/images/infisical-project-2-046666f80f3ab62a49b0a7ada396efdd.png" width="1631" height="919" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="add-required-secrets">Add required secrets<a href="#add-required-secrets" class="hash-link" aria-label="Direct link to Add required secrets" title="Direct link to Add required secrets">​</a></h2>
<p>Is important first to understand how the secrets are copied in to the VPS first, if you haven&#x27;t done already take a look first in <a href="/kickstart-selfhosted-pages/how_it_works">how it works</a> section.</p>
<p>We need to create the following 3 secrets in order to be able to complete the DNS challenge.</p>
<ol>
<li><strong>DOMAIN:</strong> The domain name for which you want to enable TLS. In this example <code>238749.xyz</code></li>
<li><strong>EMAIL:</strong> The email address which will provided to Let&#x27;s Encrypt.</li>
<li><strong>CF_DNS_API_TOKEN</strong>: The API token you generated in your Cloudflare account from the previous step. This token will be used to authenticate API requests to manage DNS records. This secret should be created inside a directory called <code>traefik</code>, since should be available only in the traefik container.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="domain-and-email-secret">DOMAIN and EMAIL Secret<a href="#domain-and-email-secret" class="hash-link" aria-label="Direct link to DOMAIN and EMAIL Secret" title="Direct link to DOMAIN and EMAIL Secret">​</a></h3>
<p>To create the secret we click on <strong>&quot;Add secret&quot;</strong> button and fill the <code>Key</code> <code>Value</code> and <code>Environments</code> where this secret will be available.
<img decoding="async" loading="lazy" src="/kickstart-selfhosted-pages/assets/images/infisical-add-secret-button-1cd2fbb10ec0e93e63a5b5ed510dc58e.png" width="962" height="478" class="img_ev3q">
<img decoding="async" loading="lazy" src="/kickstart-selfhosted-pages/assets/images/infisical-domain-secret-create-4483d896f2d81bf2da10b9707e7859b6.png" width="584" height="479" class="img_ev3q"></p>
<p>Repeat the same to create the EMAIL secret. After that it should look like the screenshot below.
<img decoding="async" loading="lazy" src="/kickstart-selfhosted-pages/assets/images/infisical-domain-secret-b06916488d0d363de3f57687f85fccdc.png" width="948" height="365" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Make sure all secrets are available for Production environment since the deployr script that downloads the secrets is looking for the secrets available for Production Environment only</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cf_dns_api_token-secret">CF_DNS_API_TOKEN secret<a href="#cf_dns_api_token-secret" class="hash-link" aria-label="Direct link to CF_DNS_API_TOKEN secret" title="Direct link to CF_DNS_API_TOKEN secret">​</a></h3>
<p>We need to create the <code>CF_DNS_API_TOKEN</code> so can be used from the Traefik container to authenticate API requests against Cloudflare. We want this secret to be available only for Traefik container, so we create it inside a directory called <code>traefik</code></p>
<p><img decoding="async" loading="lazy" src="/kickstart-selfhosted-pages/assets/images/infisical-create-directory-290d63e471423da6fd0c151d2817fc64.png" width="948" height="365" class="img_ev3q">
<img decoding="async" loading="lazy" src="/kickstart-selfhosted-pages/assets/images/infisical-traefik-directory-214a5470b178ad522b683ad7a00a8f13.png" width="948" height="393" class="img_ev3q"></p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>The name of the directory at infisical should match the name of the directory where the <code>docker-compose.yaml</code> for Traefik is stored in the apps directory. In our case both directory are <code>traefik</code></p></div></div>
<p><img decoding="async" loading="lazy" src="/kickstart-selfhosted-pages/assets/images/secrets-match-cb2a009501930bb14fbb558601d93edd.png" width="2552" height="466" class="img_ev3q"></p>
<p>Under the traefic directory you need to create a new secret called  <code>CF_DNS_API_TOKEN</code> and store the value of the API token you generated in <a href="/kickstart-selfhosted-pages/Getting_Started/preparation/cloudflare#generate-api-key">Cloudflare</a>
<img decoding="async" loading="lazy" src="/kickstart-selfhosted-pages/assets/images/infisical-traefik-secret-ce72bf241eaa52e0627d1ea55173c1a8.png" width="961" height="540" class="img_ev3q"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/kickstart-selfhosted-pages/Getting_Started/preparation/cloudflare"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">DNS &amp; TLS certificates</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/kickstart-selfhosted-pages/Getting_Started/configuration_options"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Configuration Options</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#create-a-project" class="table-of-contents__link toc-highlight">Create a Project</a></li><li><a href="#create-identity" class="table-of-contents__link toc-highlight">Create Identity</a></li><li><a href="#add-required-secrets" class="table-of-contents__link toc-highlight">Add required secrets</a><ul><li><a href="#domain-and-email-secret" class="table-of-contents__link toc-highlight">DOMAIN and EMAIL Secret</a></li><li><a href="#cf_dns_api_token-secret" class="table-of-contents__link toc-highlight">CF_DNS_API_TOKEN secret</a></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>