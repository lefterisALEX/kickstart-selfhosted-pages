"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[283],{8453:(e,t,r)=>{r.d(t,{R:()=>s,x:()=>i});var n=r(6540);const o={},a=n.createContext(o);function s(e){const t=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),n.createElement(a.Provider,{value:t},e.children)}},9105:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>u,frontMatter:()=>s,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"operations/backup-restore","title":"Backup & Restore","description":"Backup","source":"@site/docs/operations/backup-restore.md","sourceDirName":"operations","slug":"/operations/backup-restore","permalink":"/kickstart-selfhosted-pages/operations/backup-restore","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"defaultSidebar","previous":{"title":"Operations","permalink":"/kickstart-selfhosted-pages/category/operations"},"next":{"title":"Upgrade Host OS","permalink":"/kickstart-selfhosted-pages/operations/upgrade-os"}}');var o=r(4848),a=r(8453);const s={sidebar_position:1},i="Backup & Restore",c={},d=[{value:"Backup",id:"backup",level:2},{value:"Restore",id:"restore",level:2}];function p(e){const t={a:"a",admonition:"admonition",br:"br",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"backup--restore",children:"Backup & Restore"})}),"\n",(0,o.jsx)(t.h2,{id:"backup",children:"Backup"}),"\n",(0,o.jsxs)(t.p,{children:["By default, backups are enabled and executed daily using the ",(0,o.jsx)(t.a,{href:"https://github.com/offen/docker-volume-backup",children:"docker-volume-backup tool"}),". These daily backups are stored in the ",(0,o.jsx)(t.code,{children:"/backups"})," directory, with a default retention period of 7 days.",(0,o.jsx)(t.br,{}),"\n","If you rely on this module to store important data, it's crucial to implement a comprehensive backup strategy. Consider storing your backups in multiple locations, ideally including offsite options, to enhance data security. Additionally, you may want to extend the retention period to ensure that your valuable data is preserved for a longer duration."]}),"\n",(0,o.jsxs)(t.p,{children:["You can adjust the settings of the docker-volume-backup container by editing the ",(0,o.jsx)(t.code,{children:"docker-compose.yaml"})," file located at ",(0,o.jsx)(t.code,{children:"containers-host/apps/docker-backup/"}),". For instance, to increase the retention period, simply modify the ",(0,o.jsx)(t.code,{children:"BACKUP_RETENTION_DAYS"})," value.\nFor more advanced configuration options, please refer to the docker-volume-backup ",(0,o.jsx)(t.a,{href:"https://offen.github.io/docker-volume-backup/",children:"documentation"})," for detailed guidance."]}),"\n",(0,o.jsx)(t.admonition,{type:"tip",children:(0,o.jsxs)(t.p,{children:["Note that you can use the label ",(0,o.jsx)(t.code,{children:"docker-volume-backup.stop-during-backup=true"})," .This means the container will be stopped during backup to ensure."]})}),"\n",(0,o.jsx)(t.h2,{id:"restore",children:"Restore"}),"\n",(0,o.jsxs)(t.p,{children:["To restore data from a backup, you can follow the procedure outlined in the Docker Volume Backup guide ",(0,o.jsx)(t.a,{href:"https://offen.github.io/docker-volume-backup/how-tos/restore-volumes-from-backup.html",children:"documentation"}),". Below is an example workflow demonstrating how to restore the data for the ",(0,o.jsx)(t.strong,{children:"uptime_kuma"})," container using the backup file named ",(0,o.jsx)(t.code,{children:"backup-2025-05-31T03-03-00.tar.gz"}),"."]}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"1. View backup content:"})," View all the directories included in the backup file."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"tar -tvf /backups/backup-2025-05-31T03-03-00.tar.gz  | grep -E '^d.* /backup/[^/]+$'\n"})}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"2. Extract backup:"})," Extract the  ",(0,o.jsx)(t.code,{children:"uptime_kuma"}),"  content of the backup file to the ",(0,o.jsx)(t.code,{children:"/tmp"})]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"tar -C /tmp -xvf /backups/backup-2025-04-01T03-03-00.tar.gz /backup/uptime_kuma\n"})}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"3. Stop the Container:"})," Stop the uptime_kuma container to prevent any data changes during the restoration process."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"docker stop uptime-kuma\n"})}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"4. Rename Current Data:"})," For any case is good to keep temporarily a backup of the existing data you are going to replace. If backup is successful you can safely delete the copied directory."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"mv  /mnt/data/uptime-kuma /mnt/data/uptime-kuma.bak\n"})}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"5. Restore the data"})," Restore the data and ensure that the original attributes are preserved during the copying process."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"cp -a /tmp/backup/* /mnt/data/\n"})}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"6. Start the Container:"})," Start the uptime_kuma container to prevent any data changes during the restoration process."]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"docker start uptime-kuma\n"})}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.strong,{children:"7. Cleanup:"})," If backup is succesful is good to cleanup the directories you created"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"rm -rf /tmp/backup\nrm -rf /mnt/data/uptime-kuma.bak\n"})})]})}function u(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(p,{...e})}):p(e)}}}]);